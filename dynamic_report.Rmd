---
title: My dynamic report
output: html_fragment
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE)

```

```{css}

```

## Motorcycle Riding Tracking and Observations

In this report we have tracked a plethora of different factors and observations
during a motorcycle ride

### Conclusive Summaries 
```{r}
# Install and load required packages
library(tidyverse)

# Attaching CSV file and Reading contents within 
sheet_url <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vT1hYUloeMvbtVPOCnHiDfFrMwd6Lk3FSto2Crzney7eY0PTWCaatzIBRoy5rjlUTVGF6vPC3xwr7pi/pub?output=csv"
logged_data <- read_csv(sheet_url)

# Renaming columns and removing Timestamp
latest_data <- logged_data %>% 
  rename(
         Traffic_Light_Count = 2, 
         Traffic_FLow = 3,
         Weather = 4,
         Hazzards = 5,
         Reckless = 6, 
         Satisfaction = 7
         ) %>% select(-Timestamp)

# Summary values
mean_lights <- mean(latest_data$Traffic_Light_Count)
max_lights <- max(latest_data$Traffic_Light_Count)
median_satisfaction <- median(latest_data$Satisfaction)
```
* The average number of traffic lights encountered is `r mean_lights`.
* The maximum number of traffic lights encountered is `r max_lights`.
* The median ride satisfaction score is `r median_satisfaction`.

### Occurence of Traffic Lights during the Ride
```{r}
ggplot(data = latest_data) +
  geom_bar(aes(x = Traffic_Light_Count), fill = "#CB1517") +   # Ducati Red 
  labs(title = "Occurrence of Traffic Lights during the Ride",
       x = "Number of Traffic Lights per Ride",
       y = "Occurrence")
```

### Hazards on the Road vs Ride Satisfaction
```{r}
# Separate hazard categories
latest_data_longer <- latest_data %>% 
  separate_rows(Hazzards, sep = ", ") # Used to separate the categories 

ggplot(data = latest_data_longer) +
  geom_bar(aes(y = Hazzards, fill = as.factor(Satisfaction))) +
  labs(title = "Hazards present on the road compared to Ride Satisfaction",
       x = "Occurrence",
       y = "Hazard Categories")
```
